[0m12:07:47.992326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c05ffb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bf785eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bf785d60>]}


============================== 12:07:47.998964 | c20f4fc0-7b5e-4bb9-9ea6-d635e4aedb2e ==============================
[0m12:07:47.998964 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:07:48.000395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:07:48.009609 [info ] [MainThread]: dbt version: 1.9.2
[0m12:07:48.010591 [info ] [MainThread]: python version: 3.9.21
[0m12:07:48.011553 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m12:07:48.012513 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m12:07:48.072128 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:07:48.073508 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:07:48.074583 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:07:48.075837 [info ] [MainThread]: adapter type: postgres
[0m12:07:48.076814 [info ] [MainThread]: adapter version: 1.9.0
[0m12:07:48.184217 [info ] [MainThread]: Configuration:
[0m12:07:48.185395 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:07:48.186585 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:07:48.187686 [info ] [MainThread]: Required dependencies:
[0m12:07:48.188709 [debug] [MainThread]: Executing "git --help"
[0m12:07:48.192047 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:07:48.193243 [info ] [MainThread]: Connection:
[0m12:07:48.194441 [info ] [MainThread]:   host: postgres
[0m12:07:48.195451 [info ] [MainThread]:   port: 5432
[0m12:07:48.196503 [info ] [MainThread]:   user: postgres
[0m12:07:48.198075 [info ] [MainThread]:   database: sales
[0m12:07:48.199027 [info ] [MainThread]:   schema: dbt_sales
[0m12:07:48.200172 [info ] [MainThread]:   connect_timeout: 30
[0m12:07:48.201338 [info ] [MainThread]:   role: None
[0m12:07:48.202313 [info ] [MainThread]:   search_path: None
[0m12:07:48.203232 [info ] [MainThread]:   keepalives_idle: 0
[0m12:07:48.204176 [info ] [MainThread]:   sslmode: None
[0m12:07:48.205210 [info ] [MainThread]:   sslcert: None
[0m12:07:48.206368 [info ] [MainThread]:   sslkey: None
[0m12:07:48.207363 [info ] [MainThread]:   sslrootcert: None
[0m12:07:48.208557 [info ] [MainThread]:   application_name: dbt
[0m12:07:48.209662 [info ] [MainThread]:   retries: 1
[0m12:07:48.210903 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:07:48.280125 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:07:48.306184 [debug] [MainThread]: Using postgres connection "debug"
[0m12:07:48.307257 [debug] [MainThread]: On debug: select 1 as id
[0m12:07:48.308035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:48.320262 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m12:07:48.321761 [debug] [MainThread]: On debug: Close
[0m12:07:48.322607 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:07:48.323562 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:07:48.324632 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m12:07:48.326570 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.40885913, "process_in_blocks": "0", "process_kernel_time": 0.050777, "process_mem_max_rss": "103940", "process_out_blocks": "48", "process_user_time": 1.482711}
[0m12:07:48.327630 [debug] [MainThread]: Command `dbt debug` failed at 12:07:48.327509 after 0.41 seconds
[0m12:07:48.328504 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:07:48.329412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c05ffb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bf7271f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3bec3a670>]}
[0m12:07:48.330294 [debug] [MainThread]: Flushing usage events
[0m12:07:48.745957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:22.297058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0df475bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0de5f22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0de5f2250>]}


============================== 12:08:22.300295 | 80aa3106-7f26-4adb-8e4d-d5d0a3b78c61 ==============================
[0m12:08:22.300295 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:08:22.301622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --model total_sales_per_product', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:08:22.473380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80aa3106-7f26-4adb-8e4d-d5d0a3b78c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ddbdac70>]}
[0m12:08:22.533487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80aa3106-7f26-4adb-8e4d-d5d0a3b78c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ddb85cd0>]}
[0m12:08:22.534675 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:08:22.611402 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found more than one package with the name "dbt" included in this project. Package names must be unique in a project. Please rename one of these packages.
[0m12:08:22.613360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.38288203, "process_in_blocks": "0", "process_kernel_time": 0.049605, "process_mem_max_rss": "98636", "process_out_blocks": "0", "process_user_time": 1.507999}
[0m12:08:22.614386 [debug] [MainThread]: Command `dbt run` failed at 12:08:22.614276 after 0.38 seconds
[0m12:08:22.615604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0df475bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ddb74670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ddac7a60>]}
[0m12:08:22.616535 [debug] [MainThread]: Flushing usage events
[0m12:08:23.018251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:29.848431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb324eddb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb324055f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb324055eb0>]}


============================== 12:08:29.851897 | 8489a529-6246-464e-9a6c-2baa61cb5203 ==============================
[0m12:08:29.851897 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:08:29.853219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m12:08:29.972678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8489a529-6246-464e-9a6c-2baa61cb5203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3246e3a90>]}
[0m12:08:29.982584 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:08:29.985388 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:08:29.986954 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.20677958, "process_in_blocks": "0", "process_kernel_time": 0.088343, "process_mem_max_rss": "91920", "process_out_blocks": "0", "process_user_time": 1.26626}
[0m12:08:29.987996 [debug] [MainThread]: Command `dbt deps` succeeded at 12:08:29.987857 after 0.21 seconds
[0m12:08:29.988954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb324eddb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb323ffe4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3246e3a90>]}
[0m12:08:29.989915 [debug] [MainThread]: Flushing usage events
[0m12:08:30.388318 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:35.461118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2830abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e27487340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e274872e0>]}


============================== 12:08:35.464363 | bcc62c90-f452-4197-a818-c8630db12c6c ==============================
[0m12:08:35.464363 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:08:35.465649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --model total_sales_per_product', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:35.638366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcc62c90-f452-4197-a818-c8630db12c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e291fdca0>]}
[0m12:08:35.698951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcc62c90-f452-4197-a818-c8630db12c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e274c3ca0>]}
[0m12:08:35.700256 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:08:35.777611 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found more than one package with the name "dbt" included in this project. Package names must be unique in a project. Please rename one of these packages.
[0m12:08:35.779366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.38664207, "process_in_blocks": "0", "process_kernel_time": 0.049356, "process_mem_max_rss": "98344", "process_out_blocks": "0", "process_user_time": 1.51031}
[0m12:08:35.780383 [debug] [MainThread]: Command `dbt run` failed at 12:08:35.780276 after 0.39 seconds
[0m12:08:35.781301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2830abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e269f61f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e269a2d60>]}
[0m12:08:35.782228 [debug] [MainThread]: Flushing usage events
[0m12:08:36.168425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:49.709978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20c481b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20b630b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20b607d60>]}


============================== 12:11:49.713382 | 842ac834-0e09-47dd-aa9a-1d92222ee2ec ==============================
[0m12:11:49.713382 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:11:49.714746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m12:11:49.834623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '842ac834-0e09-47dd-aa9a-1d92222ee2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20b650d30>]}
[0m12:11:49.844209 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:11:49.849103 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:11:49.851492 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.20787409, "process_in_blocks": "0", "process_kernel_time": 0.07983, "process_mem_max_rss": "92008", "process_out_blocks": "0", "process_user_time": 1.27729}
[0m12:11:49.852568 [debug] [MainThread]: Command `dbt deps` succeeded at 12:11:49.852459 after 0.21 seconds
[0m12:11:49.853576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20c481b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20b519190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20b650d30>]}
[0m12:11:49.854580 [debug] [MainThread]: Flushing usage events
[0m12:11:50.263068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:22.494334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50d16bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50c2e8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50c2e82b0>]}


============================== 12:12:22.497769 | a07b99f6-5a2f-4b46-80b0-c520d75c0b1e ==============================
[0m12:12:22.497769 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:12:22.498951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --model total_sales_per_product', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:12:22.669837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a07b99f6-5a2f-4b46-80b0-c520d75c0b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50b8abf70>]}
[0m12:12:22.729940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a07b99f6-5a2f-4b46-80b0-c520d75c0b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50b8dd070>]}
[0m12:12:22.731331 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:12:22.808598 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found more than one package with the name "dbt" included in this project. Package names must be unique in a project. Please rename one of these packages.
[0m12:12:22.810550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3841788, "process_in_blocks": "0", "process_kernel_time": 0.05978, "process_mem_max_rss": "98360", "process_out_blocks": "0", "process_user_time": 1.504477}
[0m12:12:22.811558 [debug] [MainThread]: Command `dbt run` failed at 12:12:22.811453 after 0.39 seconds
[0m12:12:22.812508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50d16bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50b8c20a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50b831790>]}
[0m12:12:22.813412 [debug] [MainThread]: Flushing usage events
[0m12:12:23.213243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:00.009958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590f0ede50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590e27e280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590e27e220>]}


============================== 12:18:00.021280 | 34d3f5cf-c120-4cb1-99ec-8ea9a1a2a1ed ==============================
[0m12:18:00.021280 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:18:00.022535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:18:00.031194 [info ] [MainThread]: dbt version: 1.9.2
[0m12:18:00.032116 [info ] [MainThread]: python version: 3.9.21
[0m12:18:00.033100 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m12:18:00.034093 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m12:18:00.096027 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:18:00.097310 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:18:00.098615 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:18:00.099857 [info ] [MainThread]: adapter type: postgres
[0m12:18:00.100770 [info ] [MainThread]: adapter version: 1.9.0
[0m12:18:00.211028 [info ] [MainThread]: Configuration:
[0m12:18:00.212336 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:18:00.213366 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:18:00.214312 [info ] [MainThread]: Required dependencies:
[0m12:18:00.215406 [debug] [MainThread]: Executing "git --help"
[0m12:18:00.218650 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:18:00.219658 [info ] [MainThread]: Connection:
[0m12:18:00.220593 [info ] [MainThread]:   host: postgres
[0m12:18:00.221800 [info ] [MainThread]:   port: 5432
[0m12:18:00.223102 [info ] [MainThread]:   user: postgres
[0m12:18:00.224219 [info ] [MainThread]:   database: sales
[0m12:18:00.225166 [info ] [MainThread]:   schema: dbt_sales
[0m12:18:00.226082 [info ] [MainThread]:   connect_timeout: 30
[0m12:18:00.227402 [info ] [MainThread]:   role: None
[0m12:18:00.228635 [info ] [MainThread]:   search_path: None
[0m12:18:00.229778 [info ] [MainThread]:   keepalives_idle: 0
[0m12:18:00.230879 [info ] [MainThread]:   sslmode: None
[0m12:18:00.231913 [info ] [MainThread]:   sslcert: None
[0m12:18:00.232930 [info ] [MainThread]:   sslkey: None
[0m12:18:00.233930 [info ] [MainThread]:   sslrootcert: None
[0m12:18:00.234974 [info ] [MainThread]:   application_name: dbt
[0m12:18:00.236109 [info ] [MainThread]:   retries: 1
[0m12:18:00.237533 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:18:00.312656 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:18:00.369557 [debug] [MainThread]: Using postgres connection "debug"
[0m12:18:00.370547 [debug] [MainThread]: On debug: select 1 as id
[0m12:18:00.371421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:00.384125 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m12:18:00.385530 [debug] [MainThread]: On debug: Close
[0m12:18:00.386371 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:18:00.387434 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:18:00.388574 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m12:18:00.390610 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.44991937, "process_in_blocks": "80", "process_kernel_time": 0.182621, "process_mem_max_rss": "103984", "process_out_blocks": "1160", "process_user_time": 1.542138}
[0m12:18:00.391662 [debug] [MainThread]: Command `dbt debug` failed at 12:18:00.391548 after 0.45 seconds
[0m12:18:00.392595 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:18:00.393401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590f0ede50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590e1b74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590d731790>]}
[0m12:18:00.394306 [debug] [MainThread]: Flushing usage events
[0m12:18:00.805824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:13.002025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149ac34b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1499de1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1499dbadf0>]}


============================== 12:18:13.005425 | ae59f8c4-48eb-4c42-a5a8-ee1819f20d3e ==============================
[0m12:18:13.005425 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:18:13.006674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:18:13.131946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae59f8c4-48eb-4c42-a5a8-ee1819f20d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1499e04d30>]}
[0m12:18:13.141559 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:18:13.147698 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:18:13.149294 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.21618386, "process_in_blocks": "336", "process_kernel_time": 0.0494, "process_mem_max_rss": "92116", "process_out_blocks": "0", "process_user_time": 1.323946}
[0m12:18:13.150530 [debug] [MainThread]: Command `dbt deps` succeeded at 12:18:13.150420 after 0.22 seconds
[0m12:18:13.151464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f149ac34b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1499ccb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1499e04d30>]}
[0m12:18:13.152463 [debug] [MainThread]: Flushing usage events
[0m12:18:13.554133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:27.900860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1057cb7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1056e34340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1056e342e0>]}


============================== 12:18:27.904158 | d6f31682-11f3-4396-9127-39309565b639 ==============================
[0m12:18:27.904158 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:18:27.905309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --model total_sales_per_product', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:18:28.082613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6f31682-11f3-4396-9127-39309565b639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1058baaca0>]}
[0m12:18:28.144008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6f31682-11f3-4396-9127-39309565b639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1056e70ca0>]}
[0m12:18:28.145207 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:18:28.224721 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found more than one package with the name "dbt" included in this project. Package names must be unique in a project. Please rename one of these packages.
[0m12:18:28.226455 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.39336184, "process_in_blocks": "296", "process_kernel_time": 0.079041, "process_mem_max_rss": "98464", "process_out_blocks": "0", "process_user_time": 1.472145}
[0m12:18:28.227435 [debug] [MainThread]: Command `dbt run` failed at 12:18:28.227325 after 0.39 seconds
[0m12:18:28.228400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1057cb7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10563a31f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105634fd60>]}
[0m12:18:28.229160 [debug] [MainThread]: Flushing usage events
[0m12:18:28.636388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:06.396610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681adcbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819f53d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819f53d90>]}


============================== 12:21:06.401033 | 13c9ba56-d231-4223-947b-34779e23c45e ==============================
[0m12:21:06.401033 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:21:06.402605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:06.544951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13c9ba56-d231-4223-947b-34779e23c45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681ac69f10>]}
[0m12:21:06.556470 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23022445, "process_in_blocks": "0", "process_kernel_time": 0.099248, "process_mem_max_rss": "91724", "process_out_blocks": "0", "process_user_time": 1.300149}
[0m12:21:06.557419 [debug] [MainThread]: Command `dbt clean` succeeded at 12:21:06.557260 after 0.23 seconds
[0m12:21:06.558294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681adcbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819f6fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6819ec8760>]}
[0m12:21:06.559184 [debug] [MainThread]: Flushing usage events
[0m12:21:06.971047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:18.470963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d0a87e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39cfc182b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39cfc18250>]}


============================== 12:25:18.477089 | ca8a3589-827a-4cd3-a2ee-10105a851ed1 ==============================
[0m12:25:18.477089 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:25:18.478328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:25:18.487046 [info ] [MainThread]: dbt version: 1.9.2
[0m12:25:18.488118 [info ] [MainThread]: python version: 3.9.21
[0m12:25:18.489506 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m12:25:18.490738 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m12:25:18.552218 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:25:18.553404 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:25:18.554351 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:25:18.555467 [info ] [MainThread]: adapter type: postgres
[0m12:25:18.556399 [info ] [MainThread]: adapter version: 1.9.0
[0m12:25:18.665402 [info ] [MainThread]: Configuration:
[0m12:25:18.666552 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:25:18.667604 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:25:18.668517 [info ] [MainThread]: Required dependencies:
[0m12:25:18.669505 [debug] [MainThread]: Executing "git --help"
[0m12:25:18.672340 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:25:18.673401 [info ] [MainThread]: Connection:
[0m12:25:18.674510 [info ] [MainThread]:   host: postgres
[0m12:25:18.675486 [info ] [MainThread]:   port: 5432
[0m12:25:18.676377 [info ] [MainThread]:   user: postgres
[0m12:25:18.677438 [info ] [MainThread]:   database: sales
[0m12:25:18.678802 [info ] [MainThread]:   schema: dbt_sales
[0m12:25:18.679811 [info ] [MainThread]:   connect_timeout: 30
[0m12:25:18.680758 [info ] [MainThread]:   role: None
[0m12:25:18.681648 [info ] [MainThread]:   search_path: None
[0m12:25:18.682622 [info ] [MainThread]:   keepalives_idle: 0
[0m12:25:18.683549 [info ] [MainThread]:   sslmode: None
[0m12:25:18.684672 [info ] [MainThread]:   sslcert: None
[0m12:25:18.685896 [info ] [MainThread]:   sslkey: None
[0m12:25:18.686769 [info ] [MainThread]:   sslrootcert: None
[0m12:25:18.687709 [info ] [MainThread]:   application_name: dbt
[0m12:25:18.688764 [info ] [MainThread]:   retries: 1
[0m12:25:18.690364 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:25:18.767823 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:25:18.794538 [debug] [MainThread]: Using postgres connection "debug"
[0m12:25:18.795642 [debug] [MainThread]: On debug: select 1 as id
[0m12:25:18.796552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:18.805869 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m12:25:18.807411 [debug] [MainThread]: On debug: Close
[0m12:25:18.808408 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:25:18.809474 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:25:18.810563 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m12:25:18.812274 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.40983748, "process_in_blocks": "232", "process_kernel_time": 0.080592, "process_mem_max_rss": "104128", "process_out_blocks": "1160", "process_user_time": 1.551411}
[0m12:25:18.813311 [debug] [MainThread]: Command `dbt debug` failed at 12:25:18.813199 after 0.41 seconds
[0m12:25:18.814256 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:25:18.815165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d0a87e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39cf170970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39cf0a2b20>]}
[0m12:25:18.816033 [debug] [MainThread]: Flushing usage events
[0m12:25:19.232994 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:31.722218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0c98db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0bb0b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0bb0b2b0>]}


============================== 12:25:31.725624 | 821497e6-699a-43ba-bb45-1dc1fac8c5c3 ==============================
[0m12:25:31.725624 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:25:31.726838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --model total_sales_per_product', 'send_anonymous_usage_stats': 'True'}
[0m12:25:31.904945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '821497e6-699a-43ba-bb45-1dc1fac8c5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0b0ff5e0>]}
[0m12:25:31.965304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '821497e6-699a-43ba-bb45-1dc1fac8c5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0bcf1670>]}
[0m12:25:31.966722 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:25:32.045924 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:25:32.048715 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:25:32.049651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '821497e6-699a-43ba-bb45-1dc1fac8c5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0b085ee0>]}
[0m12:25:33.112022 [error] [MainThread]: Encountered an error:
Compilation Error in model total_sales_per_product (models/sales/total_sales_per_product.sql)
  source() takes exactly two arguments (1 given)
[0m12:25:33.114121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4610162, "process_in_blocks": "208", "process_kernel_time": 0.079054, "process_mem_max_rss": "103880", "process_out_blocks": "0", "process_user_time": 2.490222}
[0m12:25:33.115552 [debug] [MainThread]: Command `dbt run` failed at 12:25:33.115420 after 1.46 seconds
[0m12:25:33.116731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0c98db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0c810850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0ac89640>]}
[0m12:25:33.117791 [debug] [MainThread]: Flushing usage events
[0m12:25:33.510525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:30:51.981889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3190ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c30a9d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c30a9d250>]}


============================== 12:30:51.988152 | 227069e3-4a65-42d6-bc13-94ffe4e6171e ==============================
[0m12:30:51.988152 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:30:51.989716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:51.997589 [info ] [MainThread]: dbt version: 1.9.2
[0m12:30:51.998762 [info ] [MainThread]: python version: 3.9.21
[0m12:30:51.999793 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m12:30:52.000818 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m12:30:52.065400 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:30:52.066576 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:30:52.067641 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:30:52.068786 [info ] [MainThread]: adapter type: postgres
[0m12:30:52.069799 [info ] [MainThread]: adapter version: 1.9.0
[0m12:30:52.180738 [info ] [MainThread]: Configuration:
[0m12:30:52.182101 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:30:52.183312 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:30:52.184504 [info ] [MainThread]: Required dependencies:
[0m12:30:52.185606 [debug] [MainThread]: Executing "git --help"
[0m12:30:52.188732 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:30:52.189972 [info ] [MainThread]: Connection:
[0m12:30:52.191100 [info ] [MainThread]:   host: postgres
[0m12:30:52.192011 [info ] [MainThread]:   port: 5432
[0m12:30:52.192940 [info ] [MainThread]:   user: postgres
[0m12:30:52.193920 [info ] [MainThread]:   database: sales
[0m12:30:52.194909 [info ] [MainThread]:   schema: dbt_sales
[0m12:30:52.195971 [info ] [MainThread]:   connect_timeout: 30
[0m12:30:52.197106 [info ] [MainThread]:   role: None
[0m12:30:52.198306 [info ] [MainThread]:   search_path: None
[0m12:30:52.199956 [info ] [MainThread]:   keepalives_idle: 0
[0m12:30:52.203092 [info ] [MainThread]:   sslmode: None
[0m12:30:52.205148 [info ] [MainThread]:   sslcert: None
[0m12:30:52.206427 [info ] [MainThread]:   sslkey: None
[0m12:30:52.207907 [info ] [MainThread]:   sslrootcert: None
[0m12:30:52.209553 [info ] [MainThread]:   application_name: dbt
[0m12:30:52.210948 [info ] [MainThread]:   retries: 1
[0m12:30:52.213184 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:30:52.329420 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:30:52.354846 [debug] [MainThread]: Using postgres connection "debug"
[0m12:30:52.355759 [debug] [MainThread]: On debug: select 1 as id
[0m12:30:52.356750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:30:52.365457 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m12:30:52.366904 [debug] [MainThread]: On debug: Close
[0m12:30:52.367839 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:30:52.368971 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:30:52.370382 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m12:30:52.372130 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.4607929, "process_in_blocks": "136", "process_kernel_time": 0.099497, "process_mem_max_rss": "103924", "process_out_blocks": "1160", "process_user_time": 1.621811}
[0m12:30:52.373289 [debug] [MainThread]: Command `dbt debug` failed at 12:30:52.373128 after 0.46 seconds
[0m12:30:52.374316 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:30:52.375165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3190ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2fff5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c2ff27b20>]}
[0m12:30:52.376084 [debug] [MainThread]: Flushing usage events
[0m12:30:52.791835 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:04.441584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc793410be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79258e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79258e2e0>]}


============================== 12:31:04.445075 | 8820c6b1-e353-4e5d-99ae-80bedafb00cb ==============================
[0m12:31:04.445075 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:31:04.446476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --model total_sales_per_product', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:04.623332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8820c6b1-e353-4e5d-99ae-80bedafb00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc791b827f0>]}
[0m12:31:04.683618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8820c6b1-e353-4e5d-99ae-80bedafb00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7925caca0>]}
[0m12:31:04.684866 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:31:04.765917 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:31:04.768840 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:31:04.769858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8820c6b1-e353-4e5d-99ae-80bedafb00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc791a1c7c0>]}
[0m12:31:06.012265 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sales
[0m12:31:06.027821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8820c6b1-e353-4e5d-99ae-80bedafb00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76b530130>]}
[0m12:31:06.129073 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:31:06.135976 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:31:06.156199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8820c6b1-e353-4e5d-99ae-80bedafb00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76b468400>]}
[0m12:31:06.157190 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m12:31:06.158326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8820c6b1-e353-4e5d-99ae-80bedafb00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76b558a60>]}
[0m12:31:06.160547 [info ] [MainThread]: 
[0m12:31:06.161610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:06.162681 [info ] [MainThread]: 
[0m12:31:06.164109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:31:06.165958 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales'
[0m12:31:06.200540 [debug] [ThreadPool]: Using postgres connection "list_sales"
[0m12:31:06.201654 [debug] [ThreadPool]: On list_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales"} */

    select distinct nspname from pg_namespace
  
[0m12:31:06.202410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:06.211542 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m12:31:06.213940 [debug] [ThreadPool]: On list_sales: Close
[0m12:31:06.216025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales, now create_sales_dbt_sales)
[0m12:31:06.217640 [debug] [ThreadPool]: Creating schema "database: "sales"
schema: "dbt_sales"
"
[0m12:31:06.226610 [debug] [ThreadPool]: Using postgres connection "create_sales_dbt_sales"
[0m12:31:06.227968 [debug] [ThreadPool]: On create_sales_dbt_sales: BEGIN
[0m12:31:06.229063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:06.239245 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:31:06.240950 [debug] [ThreadPool]: Using postgres connection "create_sales_dbt_sales"
[0m12:31:06.242273 [debug] [ThreadPool]: On create_sales_dbt_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "create_sales_dbt_sales"} */
create schema if not exists "dbt_sales"
[0m12:31:06.245088 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:31:06.247015 [debug] [ThreadPool]: On create_sales_dbt_sales: COMMIT
[0m12:31:06.248295 [debug] [ThreadPool]: Using postgres connection "create_sales_dbt_sales"
[0m12:31:06.249515 [debug] [ThreadPool]: On create_sales_dbt_sales: COMMIT
[0m12:31:06.254574 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m12:31:06.255798 [debug] [ThreadPool]: On create_sales_dbt_sales: Close
[0m12:31:06.258574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dbt_sales, now list_sales_dbt_sales)
[0m12:31:06.268278 [debug] [ThreadPool]: Using postgres connection "list_sales_dbt_sales"
[0m12:31:06.269693 [debug] [ThreadPool]: On list_sales_dbt_sales: BEGIN
[0m12:31:06.270847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:06.279622 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:31:06.281276 [debug] [ThreadPool]: Using postgres connection "list_sales_dbt_sales"
[0m12:31:06.282984 [debug] [ThreadPool]: On list_sales_dbt_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales_dbt_sales"} */
select
      'sales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_sales'
    union all
    select
      'sales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_sales'
    union all
    select
      'sales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_sales'
  
[0m12:31:06.288225 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:31:06.291128 [debug] [ThreadPool]: On list_sales_dbt_sales: ROLLBACK
[0m12:31:06.292734 [debug] [ThreadPool]: On list_sales_dbt_sales: Close
[0m12:31:06.299908 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:06.300998 [debug] [MainThread]: On master: BEGIN
[0m12:31:06.302045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:06.310851 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:31:06.312082 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:06.313059 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:31:06.318289 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:31:06.320820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8820c6b1-e353-4e5d-99ae-80bedafb00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76a8b12e0>]}
[0m12:31:06.322229 [debug] [MainThread]: On master: ROLLBACK
[0m12:31:06.323459 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:06.324450 [debug] [MainThread]: On master: BEGIN
[0m12:31:06.326732 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:31:06.328237 [debug] [MainThread]: On master: COMMIT
[0m12:31:06.329666 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:06.330882 [debug] [MainThread]: On master: COMMIT
[0m12:31:06.332294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:31:06.333275 [debug] [MainThread]: On master: Close
[0m12:31:06.336545 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.total_sales_per_product
[0m12:31:06.338036 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt_sales.total_sales_per_product .................. [RUN]
[0m12:31:06.339379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_sales_dbt_sales, now model.dbt_postgres_project.total_sales_per_product)
[0m12:31:06.340514 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.total_sales_per_product
[0m12:31:06.352531 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.total_sales_per_product"
[0m12:31:06.366622 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.total_sales_per_product
[0m12:31:06.414338 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.total_sales_per_product"
[0m12:31:06.427655 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m12:31:06.428526 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: BEGIN
[0m12:31:06.429373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:31:06.437362 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m12:31:06.438520 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m12:31:06.439553 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */

  create view "sales"."dbt_sales"."total_sales_per_product__dbt_tmp"
    
    
  as (
    WITH sales_data AS (
    SELECT
        ProductName,
        SUM(Price*Quantity) AS total_sales,
        COUNT(SaleID) AS total_transactions
    FROM
        "sales"."public"."sales_data"
    GROUP BY
        ProductName
)
SELECT
    product_id,
    total_sales,
    total_transactions
FROM
    sales_data
WHERE
    total_sales > 1000  -- Filter out products with total sales below 1000
  );
[0m12:31:06.442150 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "product_id" does not exist
LINE 18:     product_id,
             ^

[0m12:31:06.443272 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: ROLLBACK
[0m12:31:06.444370 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: Close
[0m12:31:06.447158 [debug] [Thread-1  ]: Database Error in model total_sales_per_product (models/sales/total_sales_per_product.sql)
  column "product_id" does not exist
  LINE 18:     product_id,
               ^
  compiled code at target/run/dbt_postgres_project/models/sales/total_sales_per_product.sql
[0m12:31:06.449701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8820c6b1-e353-4e5d-99ae-80bedafb00cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76a79db50>]}
[0m12:31:06.451149 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt_sales.total_sales_per_product ......... [[31mERROR[0m in 0.11s]
[0m12:31:06.452552 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.total_sales_per_product
[0m12:31:06.453756 [debug] [Thread-4  ]: Marking all children of 'model.dbt_postgres_project.total_sales_per_product' to be skipped because of status 'error'.  Reason: Database Error in model total_sales_per_product (models/sales/total_sales_per_product.sql)
  column "product_id" does not exist
  LINE 18:     product_id,
               ^
  compiled code at target/run/dbt_postgres_project/models/sales/total_sales_per_product.sql.
[0m12:31:06.456013 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:06.456966 [debug] [MainThread]: On master: BEGIN
[0m12:31:06.457833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:31:06.466572 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:31:06.467765 [debug] [MainThread]: On master: COMMIT
[0m12:31:06.468949 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:06.469999 [debug] [MainThread]: On master: COMMIT
[0m12:31:06.471080 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:31:06.471981 [debug] [MainThread]: On master: Close
[0m12:31:06.473044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:06.473874 [debug] [MainThread]: Connection 'model.dbt_postgres_project.total_sales_per_product' was properly closed.
[0m12:31:06.474875 [info ] [MainThread]: 
[0m12:31:06.475982 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m12:31:06.477632 [debug] [MainThread]: Command end result
[0m12:31:06.514066 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:31:06.519204 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:31:06.530625 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:31:06.531852 [info ] [MainThread]: 
[0m12:31:06.533287 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:31:06.534566 [info ] [MainThread]: 
[0m12:31:06.535690 [error] [MainThread]:   Database Error in model total_sales_per_product (models/sales/total_sales_per_product.sql)
  column "product_id" does not exist
  LINE 18:     product_id,
               ^
  compiled code at target/run/dbt_postgres_project/models/sales/total_sales_per_product.sql
[0m12:31:06.537053 [info ] [MainThread]: 
[0m12:31:06.538441 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:31:06.540521 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1684542, "process_in_blocks": "96", "process_kernel_time": 0.138097, "process_mem_max_rss": "119200", "process_out_blocks": "72", "process_user_time": 2.988827}
[0m12:31:06.541854 [debug] [MainThread]: Command `dbt run` failed at 12:31:06.541672 after 2.17 seconds
[0m12:31:06.542962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc793410be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7917154f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76b47b8b0>]}
[0m12:31:06.544125 [debug] [MainThread]: Flushing usage events
[0m12:31:06.947698 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:30.852912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67bc7e6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67bb96bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67bb96bcd0>]}


============================== 12:56:30.859442 | 6dcafa6f-84ed-4ffb-893e-e434cc200608 ==============================
[0m12:56:30.859442 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:56:30.860637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:56:30.868750 [info ] [MainThread]: dbt version: 1.9.2
[0m12:56:30.869696 [info ] [MainThread]: python version: 3.9.21
[0m12:56:30.870619 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m12:56:30.871575 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m12:56:30.933727 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:56:30.935015 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:56:30.936147 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:56:30.937356 [info ] [MainThread]: adapter type: postgres
[0m12:56:30.938294 [info ] [MainThread]: adapter version: 1.9.0
[0m12:56:31.054058 [info ] [MainThread]: Configuration:
[0m12:56:31.055175 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:56:31.056274 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:56:31.057266 [info ] [MainThread]: Required dependencies:
[0m12:56:31.058211 [debug] [MainThread]: Executing "git --help"
[0m12:56:31.061182 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:56:31.062137 [info ] [MainThread]: Connection:
[0m12:56:31.063119 [info ] [MainThread]:   host: postgres
[0m12:56:31.064034 [info ] [MainThread]:   port: 5432
[0m12:56:31.065037 [info ] [MainThread]:   user: postgres
[0m12:56:31.066117 [info ] [MainThread]:   database: sales
[0m12:56:31.067060 [info ] [MainThread]:   schema: dbt_sales
[0m12:56:31.067983 [info ] [MainThread]:   connect_timeout: 30
[0m12:56:31.068969 [info ] [MainThread]:   role: None
[0m12:56:31.069945 [info ] [MainThread]:   search_path: None
[0m12:56:31.070996 [info ] [MainThread]:   keepalives_idle: 0
[0m12:56:31.072077 [info ] [MainThread]:   sslmode: None
[0m12:56:31.073273 [info ] [MainThread]:   sslcert: None
[0m12:56:31.075391 [info ] [MainThread]:   sslkey: None
[0m12:56:31.076863 [info ] [MainThread]:   sslrootcert: None
[0m12:56:31.077959 [info ] [MainThread]:   application_name: dbt
[0m12:56:31.078891 [info ] [MainThread]:   retries: 1
[0m12:56:31.080060 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:56:31.152021 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:56:31.178117 [debug] [MainThread]: Using postgres connection "debug"
[0m12:56:31.179275 [debug] [MainThread]: On debug: select 1 as id
[0m12:56:31.180087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:31.190139 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m12:56:31.191642 [debug] [MainThread]: On debug: Close
[0m12:56:31.192764 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:56:31.193800 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:56:31.194853 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m12:56:31.196444 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.41333082, "process_in_blocks": "184", "process_kernel_time": 0.122182, "process_mem_max_rss": "104072", "process_out_blocks": "1160", "process_user_time": 1.557825}
[0m12:56:31.197543 [debug] [MainThread]: Command `dbt debug` failed at 12:56:31.197347 after 0.41 seconds
[0m12:56:31.198419 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:56:31.199372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67bc7e6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67baedbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67bae99190>]}
[0m12:56:31.200314 [debug] [MainThread]: Flushing usage events
[0m12:56:31.614220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:43.338754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af6b30b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af5cad310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af5cad2b0>]}


============================== 12:56:43.342166 | 4f9ae46c-f0a8-4666-8dc3-f60df1ba851c ==============================
[0m12:56:43.342166 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:56:43.343342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --model total_sales_per_product', 'send_anonymous_usage_stats': 'True'}
[0m12:56:43.523778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f9ae46c-f0a8-4666-8dc3-f60df1ba851c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af529f5e0>]}
[0m12:56:43.586523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f9ae46c-f0a8-4666-8dc3-f60df1ba851c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af5e93670>]}
[0m12:56:43.588071 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:56:43.668589 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:56:43.840331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:56:43.841416 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_project://models/sales/total_sales_per_product.sql
[0m12:56:44.112506 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sales
[0m12:56:44.130541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f9ae46c-f0a8-4666-8dc3-f60df1ba851c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af40cd130>]}
[0m12:56:44.231483 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:56:44.238435 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:56:44.258680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f9ae46c-f0a8-4666-8dc3-f60df1ba851c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af406c460>]}
[0m12:56:44.259682 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m12:56:44.260649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f9ae46c-f0a8-4666-8dc3-f60df1ba851c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af408a5e0>]}
[0m12:56:44.262577 [info ] [MainThread]: 
[0m12:56:44.263598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:56:44.264607 [info ] [MainThread]: 
[0m12:56:44.266049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:56:44.308560 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales'
[0m12:56:44.341819 [debug] [ThreadPool]: Using postgres connection "list_sales"
[0m12:56:44.342761 [debug] [ThreadPool]: On list_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales"} */

    select distinct nspname from pg_namespace
  
[0m12:56:44.343579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:44.352200 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m12:56:44.353835 [debug] [ThreadPool]: On list_sales: Close
[0m12:56:44.355113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales, now create_sales_dbt_sales)
[0m12:56:44.356241 [debug] [ThreadPool]: Creating schema "database: "sales"
schema: "dbt_sales"
"
[0m12:56:44.362800 [debug] [ThreadPool]: Using postgres connection "create_sales_dbt_sales"
[0m12:56:44.363561 [debug] [ThreadPool]: On create_sales_dbt_sales: BEGIN
[0m12:56:44.364313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:44.372328 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:56:44.373374 [debug] [ThreadPool]: Using postgres connection "create_sales_dbt_sales"
[0m12:56:44.374211 [debug] [ThreadPool]: On create_sales_dbt_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "create_sales_dbt_sales"} */
create schema if not exists "dbt_sales"
[0m12:56:44.375326 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m12:56:44.376846 [debug] [ThreadPool]: On create_sales_dbt_sales: COMMIT
[0m12:56:44.377669 [debug] [ThreadPool]: Using postgres connection "create_sales_dbt_sales"
[0m12:56:44.378460 [debug] [ThreadPool]: On create_sales_dbt_sales: COMMIT
[0m12:56:44.383287 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m12:56:44.384286 [debug] [ThreadPool]: On create_sales_dbt_sales: Close
[0m12:56:44.385959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dbt_sales, now list_sales_dbt_sales)
[0m12:56:44.393071 [debug] [ThreadPool]: Using postgres connection "list_sales_dbt_sales"
[0m12:56:44.393868 [debug] [ThreadPool]: On list_sales_dbt_sales: BEGIN
[0m12:56:44.394685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:44.402781 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:56:44.403699 [debug] [ThreadPool]: Using postgres connection "list_sales_dbt_sales"
[0m12:56:44.404584 [debug] [ThreadPool]: On list_sales_dbt_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales_dbt_sales"} */
select
      'sales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_sales'
    union all
    select
      'sales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_sales'
    union all
    select
      'sales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_sales'
  
[0m12:56:44.407680 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:56:44.409617 [debug] [ThreadPool]: On list_sales_dbt_sales: ROLLBACK
[0m12:56:44.410492 [debug] [ThreadPool]: On list_sales_dbt_sales: Close
[0m12:56:44.416145 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:44.417017 [debug] [MainThread]: On master: BEGIN
[0m12:56:44.417852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:44.426140 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:56:44.426982 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:44.428051 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:56:44.431474 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m12:56:44.433182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f9ae46c-f0a8-4666-8dc3-f60df1ba851c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af40f4250>]}
[0m12:56:44.434128 [debug] [MainThread]: On master: ROLLBACK
[0m12:56:44.435034 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:44.435788 [debug] [MainThread]: On master: BEGIN
[0m12:56:44.436782 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:56:44.437674 [debug] [MainThread]: On master: COMMIT
[0m12:56:44.438544 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:44.439418 [debug] [MainThread]: On master: COMMIT
[0m12:56:44.440351 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:44.441183 [debug] [MainThread]: On master: Close
[0m12:56:44.443568 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.total_sales_per_product
[0m12:56:44.445352 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt_sales.total_sales_per_product .................. [RUN]
[0m12:56:44.446412 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_sales_dbt_sales, now model.dbt_postgres_project.total_sales_per_product)
[0m12:56:44.447552 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.total_sales_per_product
[0m12:56:44.457953 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.total_sales_per_product"
[0m12:56:44.464928 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.total_sales_per_product
[0m12:56:44.508289 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.total_sales_per_product"
[0m12:56:44.515313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m12:56:44.516129 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: BEGIN
[0m12:56:44.516971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:56:44.525325 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m12:56:44.526407 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m12:56:44.527401 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */

  create view "sales"."dbt_sales"."total_sales_per_product__dbt_tmp"
    
    
  as (
    WITH sales_data AS (
    SELECT
        ProductName,
        SUM(Price*Quantity) AS total_sales,
        COUNT(SaleID) AS total_transactions
    FROM
        "sales"."public"."sales_data"
    GROUP BY
        ProductName
)
SELECT
    ProductName,
    total_sales,
    total_transactions
FROM
    sales_data
WHERE
    total_sales > 1000  -- Filter out products with total sales below 1000
  );
[0m12:56:44.529694 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:56:44.537512 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m12:56:44.538357 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
alter table "sales"."dbt_sales"."total_sales_per_product__dbt_tmp" rename to "total_sales_per_product"
[0m12:56:44.539782 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:56:44.557001 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: COMMIT
[0m12:56:44.557991 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m12:56:44.558809 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: COMMIT
[0m12:56:44.574511 [debug] [Thread-1  ]: SQL status: COMMIT in 0.015 seconds
[0m12:56:44.581571 [debug] [Thread-1  ]: Applying DROP to: "sales"."dbt_sales"."total_sales_per_product__dbt_backup"
[0m12:56:44.586643 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m12:56:44.587442 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
drop view if exists "sales"."dbt_sales"."total_sales_per_product__dbt_backup" cascade
[0m12:56:44.588670 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m12:56:44.591708 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: Close
[0m12:56:44.594100 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f9ae46c-f0a8-4666-8dc3-f60df1ba851c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af4d7ec70>]}
[0m12:56:44.595182 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt_sales.total_sales_per_product ............. [[32mCREATE VIEW[0m in 0.15s]
[0m12:56:44.596749 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.total_sales_per_product
[0m12:56:44.598869 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:44.599625 [debug] [MainThread]: On master: BEGIN
[0m12:56:44.600498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:44.608654 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:56:44.609748 [debug] [MainThread]: On master: COMMIT
[0m12:56:44.610653 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:44.611805 [debug] [MainThread]: On master: COMMIT
[0m12:56:44.613144 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:44.614276 [debug] [MainThread]: On master: Close
[0m12:56:44.615649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:44.616743 [debug] [MainThread]: Connection 'model.dbt_postgres_project.total_sales_per_product' was properly closed.
[0m12:56:44.617820 [info ] [MainThread]: 
[0m12:56:44.618859 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m12:56:44.620344 [debug] [MainThread]: Command end result
[0m12:56:44.655300 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:56:44.660045 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:56:44.670285 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:56:44.671091 [info ] [MainThread]: 
[0m12:56:44.672281 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:44.673451 [info ] [MainThread]: 
[0m12:56:44.674547 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:56:44.676168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.408611, "process_in_blocks": "200", "process_kernel_time": 0.110131, "process_mem_max_rss": "116516", "process_out_blocks": "72", "process_user_time": 2.312766}
[0m12:56:44.677427 [debug] [MainThread]: Command `dbt run` succeeded at 12:56:44.677182 after 1.41 seconds
[0m12:56:44.678440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af6b30b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af4db2c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af5e93670>]}
[0m12:56:44.679377 [debug] [MainThread]: Flushing usage events
[0m12:56:45.083736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:29.346056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cd9cdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ccb4a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ccb4a2b0>]}


============================== 13:04:29.349587 | e01d44c5-d2e8-4be7-8c91-1e6245bc30f8 ==============================
[0m13:04:29.349587 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:04:29.350788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --model total_sales_per_product', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:04:29.536793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e01d44c5-d2e8-4be7-8c91-1e6245bc30f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cc13f5e0>]}
[0m13:04:29.600446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e01d44c5-d2e8-4be7-8c91-1e6245bc30f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ccd30670>]}
[0m13:04:29.601832 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:04:29.683373 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:04:29.860122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:04:29.861054 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:04:29.868522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sales
[0m13:04:29.909955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e01d44c5-d2e8-4be7-8c91-1e6245bc30f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cbce7130>]}
[0m13:04:30.016206 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:04:30.023754 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:04:30.039712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e01d44c5-d2e8-4be7-8c91-1e6245bc30f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cbceb9d0>]}
[0m13:04:30.040746 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m13:04:30.041954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e01d44c5-d2e8-4be7-8c91-1e6245bc30f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cbcfb4f0>]}
[0m13:04:30.044274 [info ] [MainThread]: 
[0m13:04:30.045787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:04:30.046854 [info ] [MainThread]: 
[0m13:04:30.048159 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:04:30.049676 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales'
[0m13:04:30.088876 [debug] [ThreadPool]: Using postgres connection "list_sales"
[0m13:04:30.090470 [debug] [ThreadPool]: On list_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales"} */

    select distinct nspname from pg_namespace
  
[0m13:04:30.092097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:30.104754 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m13:04:30.107023 [debug] [ThreadPool]: On list_sales: Close
[0m13:04:30.110452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales, now list_sales_dbt_sales)
[0m13:04:30.119625 [debug] [ThreadPool]: Using postgres connection "list_sales_dbt_sales"
[0m13:04:30.120629 [debug] [ThreadPool]: On list_sales_dbt_sales: BEGIN
[0m13:04:30.121537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:30.129577 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:04:30.130553 [debug] [ThreadPool]: Using postgres connection "list_sales_dbt_sales"
[0m13:04:30.131492 [debug] [ThreadPool]: On list_sales_dbt_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales_dbt_sales"} */
select
      'sales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_sales'
    union all
    select
      'sales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_sales'
    union all
    select
      'sales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_sales'
  
[0m13:04:30.134683 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:04:30.136665 [debug] [ThreadPool]: On list_sales_dbt_sales: ROLLBACK
[0m13:04:30.137614 [debug] [ThreadPool]: On list_sales_dbt_sales: Close
[0m13:04:30.143312 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:30.144146 [debug] [MainThread]: On master: BEGIN
[0m13:04:30.144966 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:30.153028 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:04:30.154039 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:30.155157 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:04:30.159147 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m13:04:30.161144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e01d44c5-d2e8-4be7-8c91-1e6245bc30f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cb146100>]}
[0m13:04:30.162125 [debug] [MainThread]: On master: ROLLBACK
[0m13:04:30.163173 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:30.163911 [debug] [MainThread]: On master: BEGIN
[0m13:04:30.165066 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:04:30.165919 [debug] [MainThread]: On master: COMMIT
[0m13:04:30.166810 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:30.167681 [debug] [MainThread]: On master: COMMIT
[0m13:04:30.168845 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:04:30.169774 [debug] [MainThread]: On master: Close
[0m13:04:30.172448 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.total_sales_per_product
[0m13:04:30.173446 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt_sales.total_sales_per_product .................. [RUN]
[0m13:04:30.174597 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_sales_dbt_sales, now model.dbt_postgres_project.total_sales_per_product)
[0m13:04:30.175692 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.total_sales_per_product
[0m13:04:30.186830 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.total_sales_per_product"
[0m13:04:30.194211 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.total_sales_per_product
[0m13:04:30.279255 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.total_sales_per_product"
[0m13:04:30.286171 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m13:04:30.287421 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: BEGIN
[0m13:04:30.288288 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:30.296612 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m13:04:30.297689 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m13:04:30.298662 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */

  create view "sales"."dbt_sales"."total_sales_per_product__dbt_tmp"
    
    
  as (
    WITH sales_data AS (
    SELECT
        ProductName,
        SUM(Price*Quantity) AS total_sales,
        COUNT(SaleID) AS total_transactions
    FROM
        "sales"."public"."sales_data"
    GROUP BY
        ProductName
)
SELECT
    ProductName,
    total_sales,
    total_transactions
FROM
    sales_data
WHERE
    total_sales > 1000  -- Filter out products with total sales below 1000
  );
[0m13:04:30.301216 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:04:30.309364 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m13:04:30.310301 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
alter table "sales"."dbt_sales"."total_sales_per_product" rename to "total_sales_per_product__dbt_backup"
[0m13:04:30.311658 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:04:30.315585 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m13:04:30.316502 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
alter table "sales"."dbt_sales"."total_sales_per_product__dbt_tmp" rename to "total_sales_per_product"
[0m13:04:30.317598 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:04:30.336664 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: COMMIT
[0m13:04:30.337684 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m13:04:30.338552 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: COMMIT
[0m13:04:30.343894 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m13:04:30.351362 [debug] [Thread-1  ]: Applying DROP to: "sales"."dbt_sales"."total_sales_per_product__dbt_backup"
[0m13:04:30.357073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m13:04:30.357940 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
drop view if exists "sales"."dbt_sales"."total_sales_per_product__dbt_backup" cascade
[0m13:04:30.366080 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.007 seconds
[0m13:04:30.369430 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: Close
[0m13:04:30.372013 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e01d44c5-d2e8-4be7-8c91-1e6245bc30f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cb0b5ee0>]}
[0m13:04:30.373138 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt_sales.total_sales_per_product ............. [[32mCREATE VIEW[0m in 0.20s]
[0m13:04:30.374348 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.total_sales_per_product
[0m13:04:30.376607 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:30.377538 [debug] [MainThread]: On master: BEGIN
[0m13:04:30.378501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:30.386970 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:04:30.388224 [debug] [MainThread]: On master: COMMIT
[0m13:04:30.389090 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:30.389863 [debug] [MainThread]: On master: COMMIT
[0m13:04:30.391690 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:04:30.392657 [debug] [MainThread]: On master: Close
[0m13:04:30.393741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:30.394522 [debug] [MainThread]: Connection 'model.dbt_postgres_project.total_sales_per_product' was properly closed.
[0m13:04:30.395357 [info ] [MainThread]: 
[0m13:04:30.396397 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:04:30.397992 [debug] [MainThread]: Command end result
[0m13:04:30.433657 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:04:30.438805 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:04:30.450192 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:04:30.451121 [info ] [MainThread]: 
[0m13:04:30.452254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:30.453411 [info ] [MainThread]: 
[0m13:04:30.454569 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:04:30.456625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1828535, "process_in_blocks": "3144", "process_kernel_time": 0.070086, "process_mem_max_rss": "112228", "process_out_blocks": "0", "process_user_time": 2.202717}
[0m13:04:30.457742 [debug] [MainThread]: Command `dbt run` succeeded at 13:04:30.457547 after 1.18 seconds
[0m13:04:30.458706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cd9cdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ce7b29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22cd88e2b0>]}
[0m13:04:30.459746 [debug] [MainThread]: Flushing usage events
[0m13:04:30.879056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:52:42.978896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76aaba2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a9d24d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a9d24dc0>]}


============================== 13:52:42.982299 | 45fcba00-7a76-4600-a248-72e6eb76ed10 ==============================
[0m13:52:42.982299 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:52:42.983610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --model total_sales_per_product', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:52:43.162399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45fcba00-7a76-4600-a248-72e6eb76ed10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a9d06e20>]}
[0m13:52:43.225083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45fcba00-7a76-4600-a248-72e6eb76ed10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a9daca90>]}
[0m13:52:43.226405 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:52:43.307167 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:52:43.473533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:43.474548 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:43.481962 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sales
[0m13:52:43.522350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45fcba00-7a76-4600-a248-72e6eb76ed10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a8ebc130>]}
[0m13:52:43.627384 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:52:43.634526 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:52:43.649745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45fcba00-7a76-4600-a248-72e6eb76ed10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a8ec0d90>]}
[0m13:52:43.650866 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m13:52:43.651867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45fcba00-7a76-4600-a248-72e6eb76ed10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a8ed0670>]}
[0m13:52:43.653692 [info ] [MainThread]: 
[0m13:52:43.654727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:43.655693 [info ] [MainThread]: 
[0m13:52:43.656846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:52:43.658335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales'
[0m13:52:43.696555 [debug] [ThreadPool]: Using postgres connection "list_sales"
[0m13:52:43.697538 [debug] [ThreadPool]: On list_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales"} */

    select distinct nspname from pg_namespace
  
[0m13:52:43.698479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:43.707257 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m13:52:43.709079 [debug] [ThreadPool]: On list_sales: Close
[0m13:52:43.710906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales, now list_sales_dbt_sales)
[0m13:52:43.717879 [debug] [ThreadPool]: Using postgres connection "list_sales_dbt_sales"
[0m13:52:43.718744 [debug] [ThreadPool]: On list_sales_dbt_sales: BEGIN
[0m13:52:43.719482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:43.727722 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:52:43.728786 [debug] [ThreadPool]: Using postgres connection "list_sales_dbt_sales"
[0m13:52:43.729678 [debug] [ThreadPool]: On list_sales_dbt_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales_dbt_sales"} */
select
      'sales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_sales'
    union all
    select
      'sales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_sales'
    union all
    select
      'sales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_sales'
  
[0m13:52:43.732578 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:52:43.734470 [debug] [ThreadPool]: On list_sales_dbt_sales: ROLLBACK
[0m13:52:43.735317 [debug] [ThreadPool]: On list_sales_dbt_sales: Close
[0m13:52:43.740993 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:43.741801 [debug] [MainThread]: On master: BEGIN
[0m13:52:43.742525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:43.751127 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:52:43.752009 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:43.752960 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:52:43.757110 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m13:52:43.759024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45fcba00-7a76-4600-a248-72e6eb76ed10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a831a3a0>]}
[0m13:52:43.760009 [debug] [MainThread]: On master: ROLLBACK
[0m13:52:43.761029 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:43.761770 [debug] [MainThread]: On master: BEGIN
[0m13:52:43.762827 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:52:43.763674 [debug] [MainThread]: On master: COMMIT
[0m13:52:43.764674 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:43.765615 [debug] [MainThread]: On master: COMMIT
[0m13:52:43.766652 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:52:43.767547 [debug] [MainThread]: On master: Close
[0m13:52:43.770914 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.total_sales_per_product
[0m13:52:43.772000 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt_sales.total_sales_per_product .................. [RUN]
[0m13:52:43.773074 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_sales_dbt_sales, now model.dbt_postgres_project.total_sales_per_product)
[0m13:52:43.774105 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.total_sales_per_product
[0m13:52:43.784769 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.total_sales_per_product"
[0m13:52:43.791409 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.total_sales_per_product
[0m13:52:43.873744 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.total_sales_per_product"
[0m13:52:43.880487 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m13:52:43.881287 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: BEGIN
[0m13:52:43.882058 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:43.890716 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m13:52:43.891694 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m13:52:43.892693 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */

  create view "sales"."dbt_sales"."total_sales_per_product__dbt_tmp"
    
    
  as (
    WITH sales_data AS (
    SELECT
        ProductName,
        SUM(Price*Quantity) AS total_sales,
        COUNT(SaleID) AS total_transactions
    FROM
        "sales"."public"."sales_data"
    GROUP BY
        ProductName
)
SELECT
    ProductName,
    total_sales,
    total_transactions
FROM
    sales_data
WHERE
    total_sales > 1000  -- Filter out products with total sales below 1000
  );
[0m13:52:43.895407 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:52:43.903287 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m13:52:43.904175 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
alter table "sales"."dbt_sales"."total_sales_per_product" rename to "total_sales_per_product__dbt_backup"
[0m13:52:43.905316 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:43.908971 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m13:52:43.909846 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
alter table "sales"."dbt_sales"."total_sales_per_product__dbt_tmp" rename to "total_sales_per_product"
[0m13:52:43.910996 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:43.929785 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: COMMIT
[0m13:52:43.930820 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m13:52:43.931644 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: COMMIT
[0m13:52:43.952838 [debug] [Thread-1  ]: SQL status: COMMIT in 0.020 seconds
[0m13:52:43.960385 [debug] [Thread-1  ]: Applying DROP to: "sales"."dbt_sales"."total_sales_per_product__dbt_backup"
[0m13:52:43.965471 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m13:52:43.966366 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
drop view if exists "sales"."dbt_sales"."total_sales_per_product__dbt_backup" cascade
[0m13:52:43.974385 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.007 seconds
[0m13:52:43.977622 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: Close
[0m13:52:43.979810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45fcba00-7a76-4600-a248-72e6eb76ed10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a8289eb0>]}
[0m13:52:43.980971 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt_sales.total_sales_per_product ............. [[32mCREATE VIEW[0m in 0.21s]
[0m13:52:43.982061 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.total_sales_per_product
[0m13:52:43.984145 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:43.984882 [debug] [MainThread]: On master: BEGIN
[0m13:52:43.985745 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:43.994896 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:52:43.996286 [debug] [MainThread]: On master: COMMIT
[0m13:52:43.997328 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:43.998329 [debug] [MainThread]: On master: COMMIT
[0m13:52:43.999423 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:52:44.000239 [debug] [MainThread]: On master: Close
[0m13:52:44.001222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:44.001946 [debug] [MainThread]: Connection 'model.dbt_postgres_project.total_sales_per_product' was properly closed.
[0m13:52:44.002778 [info ] [MainThread]: 
[0m13:52:44.003762 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:52:44.005072 [debug] [MainThread]: Command end result
[0m13:52:44.039314 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:52:44.043979 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:52:44.054198 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:52:44.054969 [info ] [MainThread]: 
[0m13:52:44.056034 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:44.057033 [info ] [MainThread]: 
[0m13:52:44.058089 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:52:44.059739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1556084, "process_in_blocks": "0", "process_kernel_time": 0.090978, "process_mem_max_rss": "112212", "process_out_blocks": "0", "process_user_time": 2.132941}
[0m13:52:44.060836 [debug] [MainThread]: Command `dbt run` succeeded at 13:52:44.060725 after 1.16 seconds
[0m13:52:44.061715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76aaba2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ab987970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a93591f0>]}
[0m13:52:44.062538 [debug] [MainThread]: Flushing usage events
[0m13:52:44.471380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:56.429368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b65808e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6498dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6498dd30>]}


============================== 13:59:56.435902 | 5e618c42-98e4-4447-9352-11384957ce5a ==============================
[0m13:59:56.435902 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:59:56.437262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:59:56.446203 [info ] [MainThread]: dbt version: 1.9.2
[0m13:59:56.447318 [info ] [MainThread]: python version: 3.9.21
[0m13:59:56.448445 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m13:59:56.449512 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m13:59:56.512964 [info ] [MainThread]: Using profiles dir at /dbt
[0m13:59:56.514389 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m13:59:56.515514 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m13:59:56.516752 [info ] [MainThread]: adapter type: postgres
[0m13:59:56.517802 [info ] [MainThread]: adapter version: 1.9.0
[0m13:59:56.631547 [info ] [MainThread]: Configuration:
[0m13:59:56.632782 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:59:56.633887 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:59:56.634915 [info ] [MainThread]: Required dependencies:
[0m13:59:56.636010 [debug] [MainThread]: Executing "git --help"
[0m13:59:56.638922 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m13:59:56.639949 [info ] [MainThread]: Connection:
[0m13:59:56.640937 [info ] [MainThread]:   host: postgres
[0m13:59:56.641866 [info ] [MainThread]:   port: 5432
[0m13:59:56.642743 [info ] [MainThread]:   user: postgres
[0m13:59:56.643768 [info ] [MainThread]:   database: sales
[0m13:59:56.644771 [info ] [MainThread]:   schema: dbt_sales
[0m13:59:56.645702 [info ] [MainThread]:   connect_timeout: 30
[0m13:59:56.646707 [info ] [MainThread]:   role: None
[0m13:59:56.647836 [info ] [MainThread]:   search_path: None
[0m13:59:56.649088 [info ] [MainThread]:   keepalives_idle: 0
[0m13:59:56.650158 [info ] [MainThread]:   sslmode: None
[0m13:59:56.651229 [info ] [MainThread]:   sslcert: None
[0m13:59:56.652272 [info ] [MainThread]:   sslkey: None
[0m13:59:56.653263 [info ] [MainThread]:   sslrootcert: None
[0m13:59:56.654168 [info ] [MainThread]:   application_name: dbt
[0m13:59:56.655320 [info ] [MainThread]:   retries: 1
[0m13:59:56.656829 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:59:56.726757 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:59:56.751500 [debug] [MainThread]: Using postgres connection "debug"
[0m13:59:56.752705 [debug] [MainThread]: On debug: select 1 as id
[0m13:59:56.753526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:56.761764 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m13:59:56.763249 [debug] [MainThread]: On debug: Close
[0m13:59:56.764066 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:59:56.765253 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:59:56.766523 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m13:59:56.768261 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.41080782, "process_in_blocks": "24", "process_kernel_time": 0.160399, "process_mem_max_rss": "104044", "process_out_blocks": "1160", "process_user_time": 1.523792}
[0m13:59:56.769352 [debug] [MainThread]: Command `dbt debug` failed at 13:59:56.769198 after 0.41 seconds
[0m13:59:56.770193 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:59:56.771177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b65808e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b656cd160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b656796a0>]}
[0m13:59:56.772075 [debug] [MainThread]: Flushing usage events
[0m13:59:57.191173 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:17.445971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166f753b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166e8d02b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166e8d0250>]}


============================== 14:00:17.449223 | 89448781-036e-4e4d-94f5-eaf8a8969525 ==============================
[0m14:00:17.449223 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:00:17.450500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --model total_sales_per_product', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:00:17.633381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89448781-036e-4e4d-94f5-eaf8a8969525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166e8b7e20>]}
[0m14:00:17.696125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89448781-036e-4e4d-94f5-eaf8a8969525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166e95da90>]}
[0m14:00:17.697339 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:00:17.771037 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found more than one package with the name "dbt_postgres" included in this project. Package names must be unique in a project. Please rename one of these packages.
[0m14:00:17.772716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3962651, "process_in_blocks": "0", "process_kernel_time": 0.119084, "process_mem_max_rss": "98244", "process_out_blocks": "0", "process_user_time": 1.508403}
[0m14:00:17.773844 [debug] [MainThread]: Command `dbt run` failed at 14:00:17.773737 after 0.40 seconds
[0m14:00:17.774887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166f753b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166ddbfa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166ddbf520>]}
[0m14:00:17.775893 [debug] [MainThread]: Flushing usage events
[0m14:00:18.183077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:24.973971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d3ae3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d2c75340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d2c752e0>]}


============================== 14:04:24.980364 | 6bd3f3fa-fa73-45ba-bcd2-d94e084eb479 ==============================
[0m14:04:24.980364 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:04:24.981677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m14:04:24.990111 [info ] [MainThread]: dbt version: 1.9.2
[0m14:04:24.991363 [info ] [MainThread]: python version: 3.9.21
[0m14:04:24.992409 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m14:04:24.993565 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m14:04:25.054867 [info ] [MainThread]: Using profiles dir at /dbt
[0m14:04:25.056071 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m14:04:25.057121 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m14:04:25.058327 [info ] [MainThread]: adapter type: postgres
[0m14:04:25.059345 [info ] [MainThread]: adapter version: 1.9.0
[0m14:04:25.169887 [info ] [MainThread]: Configuration:
[0m14:04:25.171220 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:04:25.172213 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:04:25.173272 [info ] [MainThread]: Required dependencies:
[0m14:04:25.174338 [debug] [MainThread]: Executing "git --help"
[0m14:04:25.177329 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:04:25.178547 [info ] [MainThread]: Connection:
[0m14:04:25.179606 [info ] [MainThread]:   host: postgres
[0m14:04:25.180509 [info ] [MainThread]:   port: 5432
[0m14:04:25.181753 [info ] [MainThread]:   user: postgres
[0m14:04:25.182696 [info ] [MainThread]:   database: sales
[0m14:04:25.183701 [info ] [MainThread]:   schema: dbt_sales
[0m14:04:25.184674 [info ] [MainThread]:   connect_timeout: 30
[0m14:04:25.185588 [info ] [MainThread]:   role: None
[0m14:04:25.186595 [info ] [MainThread]:   search_path: None
[0m14:04:25.187772 [info ] [MainThread]:   keepalives_idle: 0
[0m14:04:25.188983 [info ] [MainThread]:   sslmode: None
[0m14:04:25.190017 [info ] [MainThread]:   sslcert: None
[0m14:04:25.191010 [info ] [MainThread]:   sslkey: None
[0m14:04:25.192008 [info ] [MainThread]:   sslrootcert: None
[0m14:04:25.193069 [info ] [MainThread]:   application_name: dbt
[0m14:04:25.194161 [info ] [MainThread]:   retries: 1
[0m14:04:25.195744 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:04:25.265601 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:04:25.290042 [debug] [MainThread]: Using postgres connection "debug"
[0m14:04:25.290968 [debug] [MainThread]: On debug: select 1 as id
[0m14:04:25.291900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:25.301898 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m14:04:25.303315 [debug] [MainThread]: On debug: Close
[0m14:04:25.304243 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:04:25.305393 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:04:25.306604 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:04:25.308429 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.40311214, "process_in_blocks": "0", "process_kernel_time": 0.130537, "process_mem_max_rss": "104108", "process_out_blocks": "1160", "process_user_time": 1.536329}
[0m14:04:25.309564 [debug] [MainThread]: Command `dbt debug` failed at 14:04:25.309450 after 0.40 seconds
[0m14:04:25.310398 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:04:25.311309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d3ae3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d39a8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d39555b0>]}
[0m14:04:25.312247 [debug] [MainThread]: Flushing usage events
[0m14:04:25.724241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:35.226528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc494eeb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4866b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4866b2b0>]}


============================== 14:04:35.229788 | 90ba2740-844b-417f-970f-9d0376376897 ==============================
[0m14:04:35.229788 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:04:35.230978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --model total_sales_per_product', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:35.409825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90ba2740-844b-417f-970f-9d0376376897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc47ca4250>]}
[0m14:04:35.472325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90ba2740-844b-417f-970f-9d0376376897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc48d09d00>]}
[0m14:04:35.473596 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:04:35.555107 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:04:35.669374 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:04:35.670398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90ba2740-844b-417f-970f-9d0376376897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc49382310>]}
[0m14:04:36.932458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90ba2740-844b-417f-970f-9d0376376897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc455ff130>]}
[0m14:04:37.031832 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:04:37.039530 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:04:37.059842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90ba2740-844b-417f-970f-9d0376376897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc45614130>]}
[0m14:04:37.060867 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m14:04:37.061831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90ba2740-844b-417f-970f-9d0376376897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc45585940>]}
[0m14:04:37.064107 [info ] [MainThread]: 
[0m14:04:37.065161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:37.066260 [info ] [MainThread]: 
[0m14:04:37.067626 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:04:37.069432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales'
[0m14:04:37.103977 [debug] [ThreadPool]: Using postgres connection "list_sales"
[0m14:04:37.105106 [debug] [ThreadPool]: On list_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales"} */

    select distinct nspname from pg_namespace
  
[0m14:04:37.105997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:37.115650 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m14:04:37.117401 [debug] [ThreadPool]: On list_sales: Close
[0m14:04:37.118935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales, now create_sales_dbt_sales)
[0m14:04:37.119940 [debug] [ThreadPool]: Creating schema "database: "sales"
schema: "dbt_sales"
"
[0m14:04:37.126249 [debug] [ThreadPool]: Using postgres connection "create_sales_dbt_sales"
[0m14:04:37.127035 [debug] [ThreadPool]: On create_sales_dbt_sales: BEGIN
[0m14:04:37.127911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:37.135839 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:04:37.136882 [debug] [ThreadPool]: Using postgres connection "create_sales_dbt_sales"
[0m14:04:37.137873 [debug] [ThreadPool]: On create_sales_dbt_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "create_sales_dbt_sales"} */
create schema if not exists "dbt_sales"
[0m14:04:37.139436 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m14:04:37.140964 [debug] [ThreadPool]: On create_sales_dbt_sales: COMMIT
[0m14:04:37.141795 [debug] [ThreadPool]: Using postgres connection "create_sales_dbt_sales"
[0m14:04:37.142582 [debug] [ThreadPool]: On create_sales_dbt_sales: COMMIT
[0m14:04:37.145359 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m14:04:37.146143 [debug] [ThreadPool]: On create_sales_dbt_sales: Close
[0m14:04:37.147920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dbt_sales, now list_sales_dbt_sales)
[0m14:04:37.155004 [debug] [ThreadPool]: Using postgres connection "list_sales_dbt_sales"
[0m14:04:37.155884 [debug] [ThreadPool]: On list_sales_dbt_sales: BEGIN
[0m14:04:37.156601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:37.164665 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:04:37.165771 [debug] [ThreadPool]: Using postgres connection "list_sales_dbt_sales"
[0m14:04:37.166663 [debug] [ThreadPool]: On list_sales_dbt_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales_dbt_sales"} */
select
      'sales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_sales'
    union all
    select
      'sales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_sales'
    union all
    select
      'sales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_sales'
  
[0m14:04:37.169815 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:04:37.171701 [debug] [ThreadPool]: On list_sales_dbt_sales: ROLLBACK
[0m14:04:37.172663 [debug] [ThreadPool]: On list_sales_dbt_sales: Close
[0m14:04:37.178115 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:37.179105 [debug] [MainThread]: On master: BEGIN
[0m14:04:37.179922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:37.187881 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:04:37.188945 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:37.189905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:04:37.193252 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:04:37.194969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90ba2740-844b-417f-970f-9d0376376897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc455886d0>]}
[0m14:04:37.195989 [debug] [MainThread]: On master: ROLLBACK
[0m14:04:37.196939 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:37.197732 [debug] [MainThread]: On master: BEGIN
[0m14:04:37.198781 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:04:37.199711 [debug] [MainThread]: On master: COMMIT
[0m14:04:37.200573 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:37.201512 [debug] [MainThread]: On master: COMMIT
[0m14:04:37.202613 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:04:37.203481 [debug] [MainThread]: On master: Close
[0m14:04:37.206164 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.total_sales_per_product
[0m14:04:37.207344 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt_sales.total_sales_per_product ................. [RUN]
[0m14:04:37.208516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_sales_dbt_sales, now model.dbt_postgres_project.total_sales_per_product)
[0m14:04:37.209595 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.total_sales_per_product
[0m14:04:37.220027 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.total_sales_per_product"
[0m14:04:37.227096 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.total_sales_per_product
[0m14:04:37.274774 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.total_sales_per_product"
[0m14:04:37.281390 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:04:37.282285 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: BEGIN
[0m14:04:37.283150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:37.291218 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:04:37.292284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:04:37.293203 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */

  
    

  create  table "sales"."dbt_sales"."total_sales_per_product__dbt_tmp"
  
  
    as
  
  (
    WITH sales_data AS (
    SELECT
        ProductName,
        SUM(Price*Quantity) AS total_sales,
        COUNT(SaleID) AS total_transactions
    FROM
        "sales"."public"."sales_data"
    GROUP BY
        ProductName
)
SELECT
    ProductName,
    total_sales,
    total_transactions
FROM
    sales_data
WHERE
    total_sales > 1000  -- Filter out products with total sales below 1000
  );
  
[0m14:04:37.295436 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m14:04:37.303201 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:04:37.304117 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
alter table "sales"."dbt_sales"."total_sales_per_product__dbt_tmp" rename to "total_sales_per_product"
[0m14:04:37.305155 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:04:37.325340 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: COMMIT
[0m14:04:37.326420 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:04:37.327304 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: COMMIT
[0m14:04:37.329821 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:04:37.337132 [debug] [Thread-1  ]: Applying DROP to: "sales"."dbt_sales"."total_sales_per_product__dbt_backup"
[0m14:04:37.342349 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:04:37.343257 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
drop table if exists "sales"."dbt_sales"."total_sales_per_product__dbt_backup" cascade
[0m14:04:37.344394 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m14:04:37.347477 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: Close
[0m14:04:37.349877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90ba2740-844b-417f-970f-9d0376376897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc44959670>]}
[0m14:04:37.351096 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dbt_sales.total_sales_per_product ............ [[32mSELECT 0[0m in 0.14s]
[0m14:04:37.352325 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.total_sales_per_product
[0m14:04:37.354396 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:37.355315 [debug] [MainThread]: On master: BEGIN
[0m14:04:37.356116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:37.364645 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:04:37.365629 [debug] [MainThread]: On master: COMMIT
[0m14:04:37.366534 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:37.367485 [debug] [MainThread]: On master: COMMIT
[0m14:04:37.368583 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:04:37.369538 [debug] [MainThread]: On master: Close
[0m14:04:37.370660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:37.371548 [debug] [MainThread]: Connection 'model.dbt_postgres_project.total_sales_per_product' was properly closed.
[0m14:04:37.372434 [info ] [MainThread]: 
[0m14:04:37.373566 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m14:04:37.375050 [debug] [MainThread]: Command end result
[0m14:04:37.454317 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:04:37.458768 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:04:37.468842 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:04:37.469697 [info ] [MainThread]: 
[0m14:04:37.470809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:37.471814 [info ] [MainThread]: 
[0m14:04:37.472987 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:04:37.474870 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3179555, "process_in_blocks": "0", "process_kernel_time": 0.040187, "process_mem_max_rss": "118752", "process_out_blocks": "72", "process_user_time": 3.305442}
[0m14:04:37.475828 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:37.475726 after 2.32 seconds
[0m14:04:37.476776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc494eeb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4a6c5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfefc8370>]}
[0m14:04:37.477682 [debug] [MainThread]: Flushing usage events
[0m14:04:37.880445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:01.120280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f9820fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f97393b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f97393bb0>]}


============================== 14:06:01.126544 | 6385a722-4889-444f-9fd8-1bdd5349b1b3 ==============================
[0m14:06:01.126544 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:06:01.127788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --model total_sales_per_product', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:01.308077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6385a722-4889-444f-9fd8-1bdd5349b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f96983130>]}
[0m14:06:01.370194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6385a722-4889-444f-9fd8-1bdd5349b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f9696d790>]}
[0m14:06:01.371567 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:06:01.452478 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:06:01.619912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:01.620901 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_project://models/sales/total_sales_per_product.sql
[0m14:06:01.930036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6385a722-4889-444f-9fd8-1bdd5349b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f943a6130>]}
[0m14:06:02.046984 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:06:02.058723 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:06:02.082171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6385a722-4889-444f-9fd8-1bdd5349b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f942d4a30>]}
[0m14:06:02.083180 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m14:06:02.084241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6385a722-4889-444f-9fd8-1bdd5349b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f943b79d0>]}
[0m14:06:02.086514 [info ] [MainThread]: 
[0m14:06:02.087669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:06:02.088808 [info ] [MainThread]: 
[0m14:06:02.090080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:02.134374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales'
[0m14:06:02.168977 [debug] [ThreadPool]: Using postgres connection "list_sales"
[0m14:06:02.169983 [debug] [ThreadPool]: On list_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales"} */

    select distinct nspname from pg_namespace
  
[0m14:06:02.170744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:02.179308 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m14:06:02.181049 [debug] [ThreadPool]: On list_sales: Close
[0m14:06:02.182311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales, now create_sales_dbt_sales)
[0m14:06:02.183422 [debug] [ThreadPool]: Creating schema "database: "sales"
schema: "dbt_sales"
"
[0m14:06:02.189771 [debug] [ThreadPool]: Using postgres connection "create_sales_dbt_sales"
[0m14:06:02.190559 [debug] [ThreadPool]: On create_sales_dbt_sales: BEGIN
[0m14:06:02.191285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:02.199673 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:06:02.200690 [debug] [ThreadPool]: Using postgres connection "create_sales_dbt_sales"
[0m14:06:02.201609 [debug] [ThreadPool]: On create_sales_dbt_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "create_sales_dbt_sales"} */
create schema if not exists "dbt_sales"
[0m14:06:02.202800 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m14:06:02.204377 [debug] [ThreadPool]: On create_sales_dbt_sales: COMMIT
[0m14:06:02.205257 [debug] [ThreadPool]: Using postgres connection "create_sales_dbt_sales"
[0m14:06:02.206038 [debug] [ThreadPool]: On create_sales_dbt_sales: COMMIT
[0m14:06:02.209206 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m14:06:02.209990 [debug] [ThreadPool]: On create_sales_dbt_sales: Close
[0m14:06:02.211824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dbt_sales, now list_sales_dbt_sales)
[0m14:06:02.218799 [debug] [ThreadPool]: Using postgres connection "list_sales_dbt_sales"
[0m14:06:02.219628 [debug] [ThreadPool]: On list_sales_dbt_sales: BEGIN
[0m14:06:02.220356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:02.228202 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:06:02.229223 [debug] [ThreadPool]: Using postgres connection "list_sales_dbt_sales"
[0m14:06:02.230052 [debug] [ThreadPool]: On list_sales_dbt_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales_dbt_sales"} */
select
      'sales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_sales'
    union all
    select
      'sales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_sales'
    union all
    select
      'sales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_sales'
  
[0m14:06:02.233053 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:06:02.234796 [debug] [ThreadPool]: On list_sales_dbt_sales: ROLLBACK
[0m14:06:02.235756 [debug] [ThreadPool]: On list_sales_dbt_sales: Close
[0m14:06:02.241222 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:02.242057 [debug] [MainThread]: On master: BEGIN
[0m14:06:02.242910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:02.250720 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:06:02.251484 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:02.252455 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:02.255896 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:06:02.257685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6385a722-4889-444f-9fd8-1bdd5349b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f964c89d0>]}
[0m14:06:02.258606 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:02.259551 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:02.260304 [debug] [MainThread]: On master: BEGIN
[0m14:06:02.261384 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:06:02.262354 [debug] [MainThread]: On master: COMMIT
[0m14:06:02.263248 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:02.264054 [debug] [MainThread]: On master: COMMIT
[0m14:06:02.265155 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:06:02.266075 [debug] [MainThread]: On master: Close
[0m14:06:02.268240 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.total_sales_per_product
[0m14:06:02.270109 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt_sales.total_sales_per_product ................. [RUN]
[0m14:06:02.271302 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_sales_dbt_sales, now model.dbt_postgres_project.total_sales_per_product)
[0m14:06:02.272272 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.total_sales_per_product
[0m14:06:02.282497 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.total_sales_per_product"
[0m14:06:02.289123 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.total_sales_per_product
[0m14:06:02.336826 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.total_sales_per_product"
[0m14:06:02.343651 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:06:02.344537 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: BEGIN
[0m14:06:02.345419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:06:02.353365 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:06:02.354483 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:06:02.355441 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */

  
    

  create  table "sales"."dbt_sales"."total_sales_per_product__dbt_tmp"
  
  
    as
  
  (
    WITH sales_data AS (
    SELECT
        ProductName,
        SUM(Price*Quantity) AS total_sales,
        COUNT(SaleID) AS total_transactions
    FROM
        "sales"."public"."sales_data"
    GROUP BY
        ProductName
)
SELECT
    ProductName,
    total_sales,
    total_transactions
FROM
    sales_data
  );
  
[0m14:06:02.357541 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m14:06:02.365229 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:06:02.366128 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
alter table "sales"."dbt_sales"."total_sales_per_product__dbt_tmp" rename to "total_sales_per_product"
[0m14:06:02.367279 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:06:02.387485 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: COMMIT
[0m14:06:02.388529 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:06:02.389392 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: COMMIT
[0m14:06:02.391869 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:06:02.399037 [debug] [Thread-1  ]: Applying DROP to: "sales"."dbt_sales"."total_sales_per_product__dbt_backup"
[0m14:06:02.404063 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:06:02.405019 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
drop table if exists "sales"."dbt_sales"."total_sales_per_product__dbt_backup" cascade
[0m14:06:02.406183 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m14:06:02.409256 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: Close
[0m14:06:02.411432 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6385a722-4889-444f-9fd8-1bdd5349b1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f942d4940>]}
[0m14:06:02.412585 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dbt_sales.total_sales_per_product ............ [[32mSELECT 0[0m in 0.14s]
[0m14:06:02.413841 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.total_sales_per_product
[0m14:06:02.416040 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:02.416795 [debug] [MainThread]: On master: BEGIN
[0m14:06:02.417691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:02.425636 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:06:02.426614 [debug] [MainThread]: On master: COMMIT
[0m14:06:02.427519 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:02.428441 [debug] [MainThread]: On master: COMMIT
[0m14:06:02.429536 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:06:02.430558 [debug] [MainThread]: On master: Close
[0m14:06:02.432037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:02.432912 [debug] [MainThread]: Connection 'model.dbt_postgres_project.total_sales_per_product' was properly closed.
[0m14:06:02.433818 [info ] [MainThread]: 
[0m14:06:02.434835 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m14:06:02.436211 [debug] [MainThread]: Command end result
[0m14:06:02.471825 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:06:02.476878 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:06:02.487661 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:06:02.488512 [info ] [MainThread]: 
[0m14:06:02.489665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:02.490782 [info ] [MainThread]: 
[0m14:06:02.491763 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:06:02.493383 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4432328, "process_in_blocks": "0", "process_kernel_time": 0.126926, "process_mem_max_rss": "115168", "process_out_blocks": "1232", "process_user_time": 2.431128}
[0m14:06:02.494466 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:02.494357 after 1.44 seconds
[0m14:06:02.495460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f9820fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f98086cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f9653f5e0>]}
[0m14:06:02.496316 [debug] [MainThread]: Flushing usage events
[0m14:06:02.920935 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:10.940633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e34559e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e335ab3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e335ab340>]}


============================== 14:12:10.947352 | 6acb059d-601a-4e34-a585-551745cc78d5 ==============================
[0m14:12:10.947352 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:12:10.948677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:10.957101 [info ] [MainThread]: dbt version: 1.9.2
[0m14:12:10.958083 [info ] [MainThread]: python version: 3.9.21
[0m14:12:10.959122 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m14:12:10.960037 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m14:12:11.023704 [info ] [MainThread]: Using profiles dir at /dbt
[0m14:12:11.025005 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m14:12:11.026035 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m14:12:11.027126 [info ] [MainThread]: adapter type: postgres
[0m14:12:11.028020 [info ] [MainThread]: adapter version: 1.9.0
[0m14:12:11.140245 [info ] [MainThread]: Configuration:
[0m14:12:11.141455 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:12:11.142522 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:12:11.143545 [info ] [MainThread]: Required dependencies:
[0m14:12:11.144706 [debug] [MainThread]: Executing "git --help"
[0m14:12:11.147779 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:12:11.149094 [info ] [MainThread]: Connection:
[0m14:12:11.150134 [info ] [MainThread]:   host: postgres
[0m14:12:11.151140 [info ] [MainThread]:   port: 5432
[0m14:12:11.152374 [info ] [MainThread]:   user: postgres
[0m14:12:11.153491 [info ] [MainThread]:   database: sales
[0m14:12:11.154469 [info ] [MainThread]:   schema: public
[0m14:12:11.155466 [info ] [MainThread]:   connect_timeout: 30
[0m14:12:11.156362 [info ] [MainThread]:   role: None
[0m14:12:11.157336 [info ] [MainThread]:   search_path: None
[0m14:12:11.158299 [info ] [MainThread]:   keepalives_idle: 0
[0m14:12:11.159161 [info ] [MainThread]:   sslmode: None
[0m14:12:11.160126 [info ] [MainThread]:   sslcert: None
[0m14:12:11.161032 [info ] [MainThread]:   sslkey: None
[0m14:12:11.161963 [info ] [MainThread]:   sslrootcert: None
[0m14:12:11.163014 [info ] [MainThread]:   application_name: dbt
[0m14:12:11.164027 [info ] [MainThread]:   retries: 1
[0m14:12:11.165481 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:12:11.237098 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:12:11.262610 [debug] [MainThread]: Using postgres connection "debug"
[0m14:12:11.263539 [debug] [MainThread]: On debug: select 1 as id
[0m14:12:11.264414 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:11.272849 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m14:12:11.274367 [debug] [MainThread]: On debug: Close
[0m14:12:11.275349 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:12:11.276396 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:12:11.277482 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:12:11.279180 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.410421, "process_in_blocks": "0", "process_kernel_time": 0.152662, "process_mem_max_rss": "103908", "process_out_blocks": "1160", "process_user_time": 1.557161}
[0m14:12:11.280301 [debug] [MainThread]: Command `dbt debug` failed at 14:12:11.280149 after 0.41 seconds
[0m14:12:11.281211 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:12:11.282150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e34559e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e33570d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e32b01280>]}
[0m14:12:11.283067 [debug] [MainThread]: Flushing usage events
[0m14:12:11.690125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:52.334301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ea846be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30e99c4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30e99c42e0>]}


============================== 14:13:52.337889 | cd28efb3-ca23-496f-8652-415a94087d21 ==============================
[0m14:13:52.337889 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:13:52.339110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --model total_sales_per_product', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:13:52.532420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd28efb3-ca23-496f-8652-415a94087d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ea696b80>]}
[0m14:13:52.596718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd28efb3-ca23-496f-8652-415a94087d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30e9a21e80>]}
[0m14:13:52.598170 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:13:52.679694 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:13:52.798548 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:13:52.799833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd28efb3-ca23-496f-8652-415a94087d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ea6edb80>]}
[0m14:13:54.119155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd28efb3-ca23-496f-8652-415a94087d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30da94d130>]}
[0m14:13:54.240897 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:13:54.248648 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:13:54.272027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd28efb3-ca23-496f-8652-415a94087d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30da8df370>]}
[0m14:13:54.273099 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m14:13:54.274144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd28efb3-ca23-496f-8652-415a94087d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30da8daa00>]}
[0m14:13:54.276721 [info ] [MainThread]: 
[0m14:13:54.277843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:13:54.278798 [info ] [MainThread]: 
[0m14:13:54.280117 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:13:54.282258 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales'
[0m14:13:54.317077 [debug] [ThreadPool]: Using postgres connection "list_sales"
[0m14:13:54.318115 [debug] [ThreadPool]: On list_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales"} */

    select distinct nspname from pg_namespace
  
[0m14:13:54.318844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:54.328338 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m14:13:54.330291 [debug] [ThreadPool]: On list_sales: Close
[0m14:13:54.332150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales, now list_sales_public)
[0m14:13:54.339820 [debug] [ThreadPool]: Using postgres connection "list_sales_public"
[0m14:13:54.340743 [debug] [ThreadPool]: On list_sales_public: BEGIN
[0m14:13:54.341448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:54.349337 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:13:54.350386 [debug] [ThreadPool]: Using postgres connection "list_sales_public"
[0m14:13:54.351331 [debug] [ThreadPool]: On list_sales_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "list_sales_public"} */
select
      'sales' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:13:54.354493 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.002 seconds
[0m14:13:54.357285 [debug] [ThreadPool]: On list_sales_public: ROLLBACK
[0m14:13:54.358552 [debug] [ThreadPool]: On list_sales_public: Close
[0m14:13:54.370400 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:54.371324 [debug] [MainThread]: On master: BEGIN
[0m14:13:54.372094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:54.380198 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:13:54.381271 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:54.382215 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:13:54.385701 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:13:54.387718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd28efb3-ca23-496f-8652-415a94087d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30da962910>]}
[0m14:13:54.388679 [debug] [MainThread]: On master: ROLLBACK
[0m14:13:54.389644 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:54.390536 [debug] [MainThread]: On master: BEGIN
[0m14:13:54.391729 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:13:54.392606 [debug] [MainThread]: On master: COMMIT
[0m14:13:54.393613 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:54.394519 [debug] [MainThread]: On master: COMMIT
[0m14:13:54.395547 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:13:54.396543 [debug] [MainThread]: On master: Close
[0m14:13:54.399339 [debug] [Thread-1  ]: Began running node model.dbt_postgres_project.total_sales_per_product
[0m14:13:54.400607 [info ] [Thread-1  ]: 1 of 1 START sql table model public.total_sales_per_product .................... [RUN]
[0m14:13:54.402001 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_sales_public, now model.dbt_postgres_project.total_sales_per_product)
[0m14:13:54.402936 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_project.total_sales_per_product
[0m14:13:54.413677 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_project.total_sales_per_product"
[0m14:13:54.420415 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_project.total_sales_per_product
[0m14:13:54.470771 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_project.total_sales_per_product"
[0m14:13:54.477409 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:13:54.478368 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: BEGIN
[0m14:13:54.479185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:13:54.487397 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:13:54.488559 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:13:54.489589 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */

  
    

  create  table "sales"."public"."total_sales_per_product__dbt_tmp"
  
  
    as
  
  (
    WITH sales_data AS (
    SELECT
        ProductName,
        SUM(Price*Quantity) AS total_sales,
        COUNT(SaleID) AS total_transactions
    FROM
        "sales"."public"."sales_data"
    GROUP BY
        ProductName
)
SELECT
    ProductName,
    total_sales,
    total_transactions
FROM
    sales_data
  );
  
[0m14:13:54.492190 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.002 seconds
[0m14:13:54.500115 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:13:54.501047 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
alter table "sales"."public"."total_sales_per_product__dbt_tmp" rename to "total_sales_per_product"
[0m14:13:54.502180 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:13:54.522943 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: COMMIT
[0m14:13:54.524344 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:13:54.525456 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: COMMIT
[0m14:13:54.528111 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:13:54.535509 [debug] [Thread-1  ]: Applying DROP to: "sales"."public"."total_sales_per_product__dbt_backup"
[0m14:13:54.540879 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_project.total_sales_per_product"
[0m14:13:54.541908 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "airflow_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_project.total_sales_per_product"} */
drop table if exists "sales"."public"."total_sales_per_product__dbt_backup" cascade
[0m14:13:54.543036 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m14:13:54.546179 [debug] [Thread-1  ]: On model.dbt_postgres_project.total_sales_per_product: Close
[0m14:13:54.548511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd28efb3-ca23-496f-8652-415a94087d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d9c6a0a0>]}
[0m14:13:54.549608 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.total_sales_per_product ............... [[32mSELECT 8[0m in 0.15s]
[0m14:13:54.550864 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_project.total_sales_per_product
[0m14:13:54.553172 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:54.554178 [debug] [MainThread]: On master: BEGIN
[0m14:13:54.555064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:54.563441 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:13:54.564695 [debug] [MainThread]: On master: COMMIT
[0m14:13:54.565809 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:54.567236 [debug] [MainThread]: On master: COMMIT
[0m14:13:54.568706 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:13:54.569569 [debug] [MainThread]: On master: Close
[0m14:13:54.570584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:54.571367 [debug] [MainThread]: Connection 'model.dbt_postgres_project.total_sales_per_product' was properly closed.
[0m14:13:54.572157 [info ] [MainThread]: 
[0m14:13:54.573294 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m14:13:54.575168 [debug] [MainThread]: Command end result
[0m14:13:54.658092 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:13:54.662644 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:13:54.673201 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:13:54.674134 [info ] [MainThread]: 
[0m14:13:54.675271 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:13:54.676410 [info ] [MainThread]: 
[0m14:13:54.677842 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:13:54.679957 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.421789, "process_in_blocks": "5536", "process_kernel_time": 0.068343, "process_mem_max_rss": "119172", "process_out_blocks": "72", "process_user_time": 3.417196}
[0m14:13:54.680983 [debug] [MainThread]: Command `dbt run` succeeded at 14:13:54.680831 after 2.42 seconds
[0m14:13:54.681953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ea846be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30eba20eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ebdd0c70>]}
[0m14:13:54.682936 [debug] [MainThread]: Flushing usage events
[0m14:13:55.092219 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:03.788507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc20d7a2e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc20c933280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc20c933220>]}


============================== 15:29:03.795338 | 421b0058-c9fe-459b-ae4b-e2fbeb41cdb9 ==============================
[0m15:29:03.795338 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:29:03.796706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:03.805615 [info ] [MainThread]: dbt version: 1.9.2
[0m15:29:03.806688 [info ] [MainThread]: python version: 3.9.21
[0m15:29:03.807707 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m15:29:03.808742 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m15:29:03.875759 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m15:29:03.877194 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m15:29:03.878424 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m15:29:03.879664 [info ] [MainThread]: adapter type: postgres
[0m15:29:03.880641 [info ] [MainThread]: adapter version: 1.9.0
[0m15:29:03.993917 [info ] [MainThread]: Configuration:
[0m15:29:03.995335 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:29:03.996534 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:29:03.997521 [info ] [MainThread]: Required dependencies:
[0m15:29:03.998550 [debug] [MainThread]: Executing "git --help"
[0m15:29:04.002073 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m15:29:04.003262 [info ] [MainThread]: Connection:
[0m15:29:04.004302 [info ] [MainThread]:   host: postgres
[0m15:29:04.005222 [info ] [MainThread]:   port: 5432
[0m15:29:04.006187 [info ] [MainThread]:   user: postgres
[0m15:29:04.007115 [info ] [MainThread]:   database: sales
[0m15:29:04.008243 [info ] [MainThread]:   schema: public
[0m15:29:04.009433 [info ] [MainThread]:   connect_timeout: 30
[0m15:29:04.010588 [info ] [MainThread]:   role: None
[0m15:29:04.011902 [info ] [MainThread]:   search_path: None
[0m15:29:04.013434 [info ] [MainThread]:   keepalives_idle: 0
[0m15:29:04.014885 [info ] [MainThread]:   sslmode: None
[0m15:29:04.016010 [info ] [MainThread]:   sslcert: None
[0m15:29:04.017004 [info ] [MainThread]:   sslkey: None
[0m15:29:04.018126 [info ] [MainThread]:   sslrootcert: None
[0m15:29:04.019436 [info ] [MainThread]:   application_name: dbt
[0m15:29:04.020534 [info ] [MainThread]:   retries: 1
[0m15:29:04.022057 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:29:04.094373 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:29:04.118752 [debug] [MainThread]: Using postgres connection "debug"
[0m15:29:04.119777 [debug] [MainThread]: On debug: select 1 as id
[0m15:29:04.120652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:04.131350 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m15:29:04.132991 [debug] [MainThread]: On debug: Close
[0m15:29:04.133963 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:29:04.135125 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:29:04.136206 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m15:29:04.138727 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.42219537, "process_in_blocks": "2688", "process_kernel_time": 0.118893, "process_mem_max_rss": "103984", "process_out_blocks": "1160", "process_user_time": 1.614964}
[0m15:29:04.139873 [debug] [MainThread]: Command `dbt debug` failed at 15:29:04.139665 after 0.42 seconds
[0m15:29:04.140802 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:29:04.141685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc20d7a2e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc20bdbcb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc20c8fadc0>]}
[0m15:29:04.142602 [debug] [MainThread]: Flushing usage events
[0m15:29:04.561072 [debug] [MainThread]: An error was encountered while trying to flush usage events
